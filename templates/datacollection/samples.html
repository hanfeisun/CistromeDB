{% extends "datacollection/base.html" %}
{% load dc_extras %}

{% block title %}Cistrome Paper Collection - Samples{% endblock %}
{% block include %}
<link href="{% url static_url %}css/datasets.css" rel="stylesheet" type="text/css"/>
<script src="{% url static_url %}js/prototype.js" type="text/javascript"></script>
<script src="{% url static_url %}js/settings.js" type="text/javascript"></script>
<script src="{% url static_url %}js/samples.js" type="text/javascript"></script>
{% endblock %}

{% block login_form %}
      {% if user.is_authenticated %}
      <span id="login">Welcome, {{ user.username }}. <a href="{% url logout %}">logout</a></span>
      {% else %}
      <form action="{% url login %}" method="post" id="login">
         <label for="username">Administrator Login:</label>
	 <input type="text" name="username" id="username"/>
         <label for="password">Password:</label>
	 <input type="password" name="password" id="password"/>
	 <input type="submit" name="login" value="login"/>
      </form>
      {% endif %}
{% endblock %}

{% block onload %}
onload="init();"
{% endblock %}

{% block content %}
<!-- NOTE: the content is created in javascript -->
      {% if user.is_authenticated %}
      <!--<input type="button" id="batchEdit" value="batch edit"/>-->
      <input type="button" id="deleteBtn" value="delete"/>
      {% endif %}
      {% if pg.paginator.num_pages %}
      <div class="pagination">
          <span class="step-links">
              {% if pg.has_previous %}
	      {% ifnotequal pg.previous_page_number 1 %}
	      <a href="?page=1{{rest}}">first</a>
	      {% endifnotequal %}
              <a href="?page={{pg.previous_page_number}}{{rest}}">previous</a>
              {% endif %}

              <span class="current">Page {{ pg.number }} of {{ pg.paginator.num_pages }}.</span>

              {% if pg.has_next %}
              <a href="?page={{ pg.next_page_number }}{{rest}}">next</a>
	      {% ifnotequal pg.next_page_number pg.paginator.num_pages %}
	      <a href="?page={{pg.paginator.num_pages}}{{rest}}">last</a>
	      {% endifnotequal %}
              {% endif %}
          </span>
      </div>
      {% endif %}
      <table class="datatable" id="samples_table">
         <tr>{% if user.is_authenticated %}
	     <th><input type="checkbox" id="masterCheckbox"/></th>
	     {% endif %}
	     <th>ID</th>
	     <th>Paper</th>
	     <th>Pubmed ID</th>
	     <th>GSEID</th>
	     <th>Datasets</th>
	     <th>Uploader</th>
	     <th>Upload Date</th>
	 </tr>
	 {% for s in pg.object_list %}
	 <tr>
	     {% if user.is_authenticated %}
	     <td><input type="checkbox" class="rowSelect" id="{{s.id}}"/>
	         <a href="{% url update_sample_form s.id %}">edit</a>
	     </td>
	     {% endif %}
	     <td><a href="{% url sample_profile s.id %}">{{ s.id }}</a></td>
	     <td><a href="{% url paper_profile s.paper.id %}">{{ s.paper.id }}</a></td>
	     <td><a href="http://www.ncbi.nlm.nih.gov/pubmed?term={{s.paper.pmid}}" target="_blank">{{ s.paper.pmid }}</a></td>
	     <td><a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc={{s.paper.gseid}}" target="_blank">{{ s.paper.gseid }}</a></td>
	     <td>{{ s.datasets }}</td>
	     <td>{{ s.uploader }}</td>
	     <td>{{ s.upload_date|date:"Y-m-d" }}</td>
	 </tr>
	 {% endfor %}
      </table>
      {% if pg.paginator.num_pages %}
      <div class="pagination">
          <span class="step-links">
              {% if pg.has_previous %}
	      {% ifnotequal pg.previous_page_number 1 %}
	      <a href="?page=1{{rest}}">first</a>
	      {% endifnotequal %}
              <a href="?page={{pg.previous_page_number}}{{rest}}">previous</a>
              {% endif %}

              <span class="current">Page {{ pg.number }} of {{ pg.paginator.num_pages }}.</span>

              {% if pg.has_next %}
              <a href="?page={{ pg.next_page_number }}{{rest}}">next</a>
	      {% ifnotequal pg.next_page_number pg.paginator.num_pages %}
	      <a href="?page={{pg.paginator.num_pages}}{{rest}}">last</a>
	      {% endifnotequal %}
              {% endif %}
          </span>
      </div>
      {% endif %}
{% endblock %}

