{% extends "datacollection/base.html" %}

{% block title %}Cistrome Paper Collection{% endblock %}
{% block include %}
<link href="{% url static_url %}css/admin.css" rel="stylesheet" type="text/css"/>
<!--
<script src="{% url static_url %}js/prototype.js" type="text/javascript"></script>
<script src="{% url static_url %}js/Utils.js" type="text/javascript"></script>
<script src="{% url static_url %}js/Models.js" type="text/javascript"></script>
<script src="{% url static_url %}js/settings.js" type="text/javascript"></script>
<script src="{% url static_url %}js/admin.js" type="text/javascript"></script>
-->
{% endblock %}

{% block login_form %}
      {% if user.is_authenticated %}
      <span id="login">Welcome, {{ user.username }}. <a href="{% url logout %}">logout</a></span>
      {% endif %}
{% endblock %}

{% block onload %}
onload="init();"
{% endblock %}

{% block content %}
<!-- NOTE: the content is created in javascript -->
      {% if user.is_authenticated %}
      <a href="{% url new_paper_form %}" style="float:right">add new paper</a>
      {% endif %}
      <table class="datatable" id="papers_table">
         <tr><th>ID</th>
	     <th>Pubmed ID</th>
	     <th>GSEID</th>
	     <th>Species</th>
	     <th>Factors</th>
	     <th>Status</th>
	     <th>Comments</th>
	     <th>Curator</th>
	     <th>Date Added</th>
	 </tr>
	 {% for p in papers %}
	 <tr>
	     <td><a href="{% url paper_profile p.id %}">{{ p.id }}</a></td>
	     <td><a href="{% url paper_profile p.id %}">{{ p.pmid }}</a></td>
	     <td><a href="{% url paper_profile p.id %}">{{ p.gseid }}</a></td>
	     <td>{% for s in p.species %}
	         {{ s }}
		 {% endfor %}
	     </td>
	     <td>{% for f in p.factors %}
	         {{ f }}
		 {% endfor %}
	     </td>
	     {% ifequal p.status "imported" %}
	     <td class="imported_row">{{ p.get_status_display }}</td>
	     {% else %} {% ifequal p.status "datasets" %}
	     <td class="datasets_row">{{ p.get_status_display }}</td>
	     {% else %} {% ifequal p.status "downloaded" %}
	     <td class="downloaded_row">{{ p.get_status_display }}</td>
	     {% else %} {% ifequal p.status "complete" %}
	     <td class="complete_row">{{ p.get_status_display }}</td>
	     {% else %} {% ifequal p.status "error" %}
	     <td class="error_row">{{ p.get_status_display }}</td>
	     {% else %}
	     <td>{{ p.get_status_display }}</td>
	     {% endifequal %}{% endifequal %}{% endifequal %}{% endifequal %}{% endifequal %}
	     <td>{{ p.comments }}</td>
	     <td>{{ p.user }}</td>
	     <td>{{ p.date_collected|date:"Y-m-d" }}</td>
	 </tr>
	 {% endfor %}
      </table>
{% endblock %}

<!--
<html>
<head>
   <link href="{% url static_url %}css/all_papers.css" rel="stylesheet" type="text/css"/>
   <script>

{% autoescape off %}
//this needs to be converted--i.e. the nodes need to be made into Motif objs.
var papersList_json = {{ papersList }}

function helper(i) {
   parent.papersModel.setCurrentPaperID(i);
}

{% endautoescape %} 
   </script>
</head>
<body onload="parent.initPage(papersList_json);">
   <div id="papers_div">
      <table class="datatable" id="papers_table">
         <tr><th>Pubmed ID</th>
	     <th>Title</th>
	     <th>Authors</th>
	     <th>Journal</th>
	     <th>Published</th>
	 </tr>
	 {% for p in papers %}
	 {% if forloop.counter0|divisibleby:2 %}
	 <tr class="row" onclick="helper({{ forloop.counter0 }});">
	 {% else %}
	 <tr class="altrow" onclick="helper({{ forloop.counter0 }});">
	 {% endif %}
	     <td>{{ p.pmid }}</td>
	     <td>{{ p.title|truncatewords:5 }}</td>
	     <td>{{ p.authors|truncatewords:4 }}</td>
	     <td>{{ p.journal }}</td>
	     <td>{{ p.pub_date|date:"M Y" }}</td>
	 </tr>
	 {% endfor %}
      </table>
   </div>
</body>
</html>
-->
